# --- minimal TLS hardening (safe + not too strict) ---

# Hide version
server_tokens off;

# TLS versions (modern baseline)
ssl_protocols TLSv1.2 TLSv1.3;

# TLS 1.3 cipher suites are managed by OpenSSL; this line affects TLS1.2
ssl_ciphers HIGH:!aNULL:!MD5:!3DES:!DES:!RC4:!DSS:!SHA1:!kRSA;
ssl_prefer_server_ciphers off;

# Session settings
ssl_session_cache shared:SSL:10m;
ssl_session_timeout 10m;
ssl_session_tickets off;

# (Optional) OCSP stapling - enable only if resolver works reliably
# ssl_stapling on;
# ssl_stapling_verify on;
# resolver 1.1.1.1 9.9.9.9 valid=300s;
# resolver_timeout 5s;

# Security headers (minimal)
add_header X-Content-Type-Options "nosniff" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# HSTS: start mild (no preload, no includeSubDomains)
# Once you're confident, you can extend max-age gradually.
add_header Strict-Transport-Security "max-age=86400" always;  # 1 day
